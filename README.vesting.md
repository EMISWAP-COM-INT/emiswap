# Vesting contract README

Контракт предназначен для хранения информации о замороженных токенах. Замораживает токены из пула advisors и произвольные токены на 1 год с поквартальной разморозкой.
Замороженные токены хранятся на адресе контракта.

## Инициализация (конструктор)

При инициализации передается один параметр: адрес токена ERC20, который будет замораживаться.

## Замораживание произвольных токенов

Для замораживания токенов предусмотрены 2 похожих метода:
 - _freeze(wallet, amount, category)_ и
 - _freeze(wallet, startDate, amount, category)_

отличие в том, что во втором варианте можно указать дату, с которой начинать отсчет заморозки (необходим для token presale)

## Категории локов

При записи локов указывается категория, к которым относится указанный лок. В настоящее время для категорий используются следующие значения:

1. Crowdsale
2. Crowdsale referral
3. Swapper
4. Liquidity provider
5. Swapper referral
6. Ambassador

Эти значения возвращаются при вызове методов _getLock_ и _getMyLock_ вместе с датой заморозки и суммой заморозки.

## Получение статистики по кошельку

Для получения статистики по кошельку и категории используется метод _getMyStats(category)_, которая возвращает массив из 4 чисел:
 - aсquired (количество начисленных токенов)
 - minted (количество сминченных токенов)
 - mintable (доступное для минта количество токенов)

Для администраторов доступна также метод _getStats(wallet, category)_, который возвращает вышеуказанные данные по любому указанному кошельку.

## Перевод размороженных токенов
Для перевода (claim) размороженных токенов владелец кошелька должен вызвать permissionless метод _claim()_.
Метод проверяет локи владельца кошелька и переводит размороженные токены на адрес вызывающего.

## Специальные роли
В контракте предусмотрено использование 2 специальных ролей: администратор (владелец) и администратор эдвайзеров.

### Owner (Admin)
Администратор может выполнять все привилегированные методы кроме методов для работы с эдвайзерами. Кроме того, администратор 
может поменять администратора эдвайзеров в любой момент.

### AdvisorAdmin
Администратор эдвайзеров может выполнять только привилегированные методы для работы с эдвайзерами.

## Внесение записи об advisor
Для внесения записи о начислениях эдвайзеру предусмотрен метод _addAdvisorLock(wallet, lockedAmount, unlockedAmount)_.
Параметры метода:
 - wallet: адрес кошелька эдвайзера
 - lockedAmount: кол-во замороженных токенов
 - unlockedAmount: кол-во размороженных токенов

Метод отслеживает переполнение пула токенов обоих типов.

## Минт токенов advisor
Для минта (фактического создания и получения разлоченной части токенов) предусмотрен метод _mintAdvisor()_.
Его должен выполнить владелец кошелька, на котором есть записи о начислениях.

В таком случае метод создает размороженные токены на кошельке в разрешенном объеме и создает замороженные 
токены с датой начала заморозки = текущее время.

## Получение информации о локах
Для получения информации о локах и замороженных токенов, предусмотрены следующие методы:

Для любого кошелька:

 - _getMyLocksLen()_: вернуть количество записей заморозки для вызывающего кошелька
 - _getMyLock(idx)_: вернуть запись заморозки с индексом idx для вызывающего кошелька (idx исчисляется с 0 и должен быть меньше общего числа записей)
 - _getNextUnlock()_: возвращает ближайшую дату и количество следующей порции разморозки токенов

Для привилегированного кошелька (администратора):
 - _getLocksLen(wallet)_: вернуть количество записей заморозки для адреса кошелька wallet
 - _getLock(wallet, idx)_: вернуть запись о заморозке с индексом idx для адреса кошелька wallet

Для привилегированного кошелька (администратора эдвайзеров):
 - _getAdvisorLock(wallet)_: просмотр записи о начислениях эдайзеру wallet

## Safety: перевод произвольных токенов ERC20, попавших на адрес контракта
Для перевода произвольных токенов ERC20, случайно попавших на адрес контракта, предусмотрен метод 
_transferAnyERC20Token(token, wallet, amount)_
